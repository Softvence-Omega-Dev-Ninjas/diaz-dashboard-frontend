// src/redux/api/baseApi.ts
import { createApi, fetchBaseQuery } from '@reduxjs/toolkit/query/react';
import type { RootState } from '../store';

// Use environment variable or fallback to hardcoded URL
const API_BASE_URL = 'https://api.floridayachttrader.com';

console.log('ðŸ”§ Redux API Base URL:', API_BASE_URL);

export const baseApi = createApi({
  reducerPath: 'baseApi',
  baseQuery: fetchBaseQuery({
    baseUrl: `${API_BASE_URL}/api`,
    prepareHeaders: (headers, { getState }) => {
      const state = getState() as RootState;
      console.log('Current State:', state); // Debugging line to check the state structure
      const token = state.auth?.token;

      if (token) {
        headers.set('Authorization', `Bearer ${token}`);
        console.log(token);
      }
      return headers;
    },
  }),

  tagTypes: [
    'Auth',
    'User',
    'Yacht',
    'Seller',
    'Dashboard',
    'Activity',
    'Admin',
    'Listing',
    'PERMISSION',
    'Blog',
    'TermsOfService',
    'AboutUs',
    'PrivacyPolicy',
    'ContactUs',
    'Footer',
    'Leads',
    'FAQ',
    'WhyUs',
    'OurTeam',
    'FeaturedBrands',
    'Category',
    'ContactInfo',
  ],

  endpoints: () => ({}),
});
